@model WebBack.Models.Biz.Machine.BindViewModel
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_LayoutHomeDialog.cshtml";
}

@section scripts{
    <script type="text/javascript">


        $(this).ready(function () {
            $.formValidator.initConfig({ formID: "form1", onError: function (msg) { $.lumos.tips(msg); }, onSuccess: function () { return edit(); } });
        });

        function edit() {
            var merchantId = $('#Model_SysMerchantUser_Id').val();
            if (merchantId == '') {
                $.lumos.tips('请选择商户');
                return;
            }

            var len = $('#btn_select_mrchUser').length;
            var opName = len > 0 ? "绑定" : "解绑";
            art.dialog.confirm(
'确定要' + opName + '？',
function () {

    var array = new Array();
    var machineId = $('#Model_Machine_Id').val();
    array.push({ name: "merchantId", value: merchantId });
    array.push({ name: "machineId", value: machineId });

    $.lumos.postJson({
        url: "/Biz/Machine/Bind",
        data: array,
        success: function (d) {
            if (d.result == $.lumos.resultType.success) {
                $.lumos.parentDialog.listTable.loadData();
                $.lumos.tips(d.message, true);
            }
            else {
                $.lumos.tips(d.message);
            }

        }
    });
});
            return false;
        }

        function getMerchantDetails(obj) {

            $('#Model_SysMerchantUser_Id').val(obj.id);
            $('#lbl_SysMerchantUser_MerchantName').text(obj.merchantName);
            $('#lbl_SysMerchantUser_ContactName').text(obj.contactName);
            $('#lbl_SysMerchantUser_ContactPhone').text(obj.contactPhone);
            $('#lbl_SysMerchantUser_ContactAddress').text(obj.contactAddress);
        }

        //-->
    </script>
}

<form id="form1">

    <input name="Model.Machine.Id" id="Model_Machine_Id" type="hidden" value="@Model.Machine.Id" />
    <input name="Model.SysMerchantUser.Id" id="Model_SysMerchantUser_Id" type="hidden" value="@Model.SysMerchantUser.Id" />
    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>机器信息</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>
    <table class="f-tb" cellpadding="0" cellspacing="1" style="width:100%">
        <tr>
            <td class="f-tb-t">设备ID：</td>
            <td class="f-tb-c">@Model.Machine.DeviceId</td>
            <td class="f-tb-t">Mac地址：</td>
            <td class="f-tb-c">@Model.Machine.MacAddress</td>
        </tr>
        <tr>
            <td class="f-tb-t">名称：</td>
            <td class="f-tb-c">@Model.Machine.Name</td>
            <td class="f-tb-t"></td>
            <td class="f-tb-c"></td>
        </tr>
    </table>
    <div class="gbr-row-title clearfix">
        <div class="pull-left">
            <h5>商户信息</h5>
        </div>
        <div class="pull-right f-tb1-item-pull-right">
            <h6></h6>
        </div>
    </div>

    <table class="f-tb" cellpadding="0" cellspacing="1" style="width:100%">
        <tr>
            <td class="f-tb-t">
                商户名称：
            </td>
            <td class="f-tb-c">

                <span id="lbl_SysMerchantUser_Name">@Model.SysMerchantUser.MerchantName</span>


                @if (!Model.Machine.IsUse)
                {
                    <span> <input type="button" class="btn" id="btn_select_mrchUser" value="选择" dialog-title="选择" /></span>
                }
            </td>
        </tr>
        <tr>
            <td class="f-tb-t">
                联系人：
            </td>
            <td class="f-tb-c">
                <span id="lbl_SysMerchantUser_ContactName"> @Model.SysMerchantUser.ContactName</span>
            </td>
        </tr>
        <tr>
            <td class="f-tb-t">
                联系电话：
            </td>
            <td class="f-tb-c">
                <span id="lbl_SysMerchantUser_ContactPhone">   @Model.SysMerchantUser.ContactPhone</span>
            </td>
        </tr>
        <tr>
            <td class="f-tb-t">
                联系地址：
            </td>
            <td class="f-tb-c">
                <span id="lbl_SysMerchantUser_ContactAddress">   @Model.SysMerchantUser.ContactAddress</span>
            </td>
        </tr>
    </table>

</form>

